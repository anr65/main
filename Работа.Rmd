---
title: "Работа"
author: "Утята"
date: "4/12/2021"
output: html_document
---

```{r}
library(DescTools)
library(EnvStats)
library(outliers)
library(ggplot2)
library(ggpubr)
library(Hmisc)
library(corrplot)
library(rio)
library(robustHD)
library(normtest)
library(GGally)
library(leaps)
library(tidyr)
library(sjPlot)
library(dplyr)

data <- read.csv('datas1.csv')
data <- data[rowSums(is.na(data)) == 0,]
data
```

```{r}
Desc(data)
```
Выделим данные объясняющей переменной
```{r}
data <- select(data, -X)
data <- select(data, -sl_no)
data_cont <- data
summaryStats(data_cont)
```
Присвоим целевое целевое значение переменной Y
```{r}
Y <- data$salary
Desc(Y)
```
### Проверка IQR

```{r}
IQR(Y)/2/median(Y)
```
Данные однородны 

## Правило 3 сигм
```{r}
lower_mu = mean(Y) - 3*sd(Y)
upper_mu = mean(Y) + 3*sd(Y)
low_outliers = which(Y < lower_mu)
high_outliers = which(Y > upper_mu)
```


```{r}
cat(c('Выбросы из правила 3 сигм относительно нижней границы доверительного интервала:', low_outliers))
```
Нема выбросов


```{r}
cat(c('Выбросы из правила 3 сигм относительно верхней границы доверительного интервала:', high_outliers))
```


## 1.5IQR
```{r}
out_of_1.5IQR <- boxplot.stats(Y)$out 
out_of_1.5IQR_ind <- which(Y %in% out_of_1.5IQR)
out_of_1.5IQR_ind
```


## 3IQR
```{r}
out_of_3IQR <- boxplot.stats(Y, coef = 3)$out 
out_of_3IQR_ind <- which(Y %in% out_of_3IQR)
out_of_3IQR_ind
```
Вот же они выбросы

```{r}
clearData <- data_cont[-out_of_1.5IQR_ind, ]
median(clearData$salary)
```

```{r}
mean(clearData$salary)
```

### Диаграммы

```{r}
boxplot(Y, col = '#aaf0d1')
```
```{r}
boxplot(clearData$salary, col = '#aaf0d1')
```
Не ебу зачем но стандартизируем другие переменные и сделаем боксплот..
```{r}
rdata <- clearData
rdata$ssc_p <- robStandardize(clearData$ssc_p)
rdata$hsc_p <- robStandardize(clearData$hsc_p)
rdata$degree_p <- robStandardize(clearData$degree_p)
rdata$etest_p <- robStandardize(clearData$etest_p)
rdata$mba_p <- robStandardize(clearData$mba_p)
rdata$gender_M <- robStandardize(clearData$gender_M)
rdata$ssc_b_Others <- robStandardize(clearData$ssc_b_Others)
rdata$hsc_b_Others <- robStandardize(clearData$hsc_b_Others)
rdata$hsc_s_Commerce <- robStandardize(clearData$hsc_s_Commerce)
rdata$hsc_s_Science <- robStandardize(clearData$hsc_s_Science)
rdata$degree_t_Others <- robStandardize(clearData$degree_t_Others)
rdata$degree_t_Sci.Tech <- robStandardize(clearData$degree_t_Sci.Tech)
rdata$workex_Yes <- robStandardize(clearData$workex_Yes)
rdata$specialisation_Mkt.HR <- robStandardize(clearData$specialisation_Mkt.HR)
rdata$status_Placed <- robStandardize(clearData$status_Placed)
boxplot(rdata, varwidth = TRUE, col = "bisque", main = "Ящичковая диаграмма для объясняющих и целевой переменных")
```
Короче бля нихуя из этого не вышло


Тест Граббса
```{r}
Y <- clearData$salary
grubbs.test(Y)
```

Тест Рознера
```{r}
rosnerTest(Y, k = 10)
```
Короче выводы сами делайте


### Проверка на нормальность

```{r}
print("Коэффициенты асимметрии для непрерывных переменных составляют...")
apply(data_cont, 2, Skew)
```
```{r}
print("Коэффициенты эксцесса для непрерывных переменных составляют...")
apply(data_cont, 2, Kurt) 
```


```{r}
hist(Y, breaks = 'Sturges', freq = FALSE, col = '#afeeee')
```

```{r}
hist(log(Y), breaks = 'Sturges', freq = FALSE, col = '#afeeee')
```

```{r}
stem(Y)
```

```{r}
ggplot(clearData, aes(x = round(Y/1000, 0))) + geom_dotplot(binwidth = 1.5, stackdir = "center")
```

```{r}
stem(log(Y))
```
```{r}
ggplot(clearData, aes(x = log(Y))) + geom_dotplot(stackdir = "center")
```

## Тесты

```{r}
PearsonTest(log(Y))
```
```{r}
shapiro.test(log(Y))
```

```{r}
JarqueBeraTest(log(Y), robust = FALSE)
```

```{r}
ks.test(log(Y), rnorm(132, mean = mean(log(Y)), sd = sd(log(Y))))
```
Присвоим
```{r}
clearData$salary <- log(Y)
```



